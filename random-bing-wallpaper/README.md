# Random Bing Wallpaper

一个自动下载并设置必应随机壁纸的 Python 工具，支持定时更换桌面壁纸。

## ✨ 功能特性

- 🖼️ **自动下载**：从必应随机壁纸API获取高质量壁纸
- 🔄 **定时更换**：支持自定义时间间隔自动更换壁纸
- 💾 **本地缓存**：自动保存下载的壁纸到本地Pictures文件夹
- 🔍 **去重机制**：使用SHA256哈希值避免重复下载相同壁纸
- 🎲 **离线备用**：网络异常时从本地图片库随机选择壁纸
- 🖥️ **Windows兼容**：使用Windows API直接设置桌面壁纸

## 🚀 快速开始

### 安装依赖

```bash
pip install -r requirements.txt
```

### 运行程序

**默认模式（60秒间隔）：**
```bash
python main.pyw
```

**自定义时间间隔：**
```bash
python main.pyw 300  # 每5分钟更换一次
```

## 📋 使用说明

### 命令行参数

- `sleep_time`（可选）：壁纸更换间隔时间，单位为秒，默认60秒

### 文件结构

运行后会在当前目录创建以下文件/文件夹：

```
random-bing-wallpaper/
├── main.pyw              # 主程序文件
├── requirements.txt      # 依赖包列表
├── README.md            # 说明文档
├── wallpaper.jpg        # 临时壁纸文件
└── Pictures/            # 壁纸缓存文件夹
    ├── [hash1].jpg      # 已下载的壁纸（按SHA256命名）
    ├── [hash2].jpg
    └── ...
```

## 🔧 工作原理

1. **下载壁纸**：从 `https://bing.img.run/rand.php` 获取随机必应壁纸
2. **计算哈希**：使用SHA256算法计算图片哈希值
3. **去重处理**：检查是否已存在相同哈希的图片，避免重复保存
4. **设置壁纸**：调用Windows API设置为桌面壁纸
5. **本地备份**：将图片保存到Pictures文件夹作为缓存
6. **循环执行**：等待指定时间后重复上述过程

## 🛡️ 错误处理

- **网络异常**：当无法下载新壁纸时，程序会从本地Pictures文件夹随机选择一张图片作为壁纸
- **文件冲突**：如果发现相同哈希的图片，会自动删除旧文件并保存新文件
- **空文件夹**：如果Pictures文件夹为空且网络异常，程序会提示用户

## 📝 技术细节

### 依赖库

- `requests`：用于HTTP请求下载壁纸
- `ctypes`：调用Windows API设置壁纸
- `hashlib`：计算文件SHA256哈希值
- `pathlib`：现代化的文件路径处理

### 支持的图片格式

- JPG/JPEG
- PNG

### 系统要求

- **操作系统**：Windows
- **Python版本**：3.6+

## ⚠️ 注意事项

1. 本程序仅支持Windows系统
2. 需要网络连接以下载新壁纸
3. 程序会持续运行，可使用Ctrl+C终止
4. 建议将程序添加到系统启动项以实现开机自动运行

## 🔗 API说明

使用的壁纸API：`https://bing.img.run/rand.php`
- 提供必应搜索的随机高质量壁纸
- 无需API密钥
- 返回JPG格式图片

---

> 💡 **提示**：建议设置较长的时间间隔（如300秒或更长），避免频繁请求API。